@import "tailwindcss";
@plugin "@tailwindcss/typography";

@theme inline {
  --color-background: var(--background);
  --color-foreground: var(--foreground);
  --font-sans: var(--font-geist-sans);
  --font-mono: var(--font-geist-mono);
  --font-heading: var(--font-space-grotesk);
}

/* ============================================================
   Light / Dark theme custom properties
   Switched via .dark class on <html> (next-themes, class strategy)
   ============================================================ */

:root {
  --background: #fafafa;
  --foreground: #171717;
  --muted: #737373;
  --border: #e5e5e5;
  --hover-bg: #f5f5f5;
  --accent: #3b82f6;
}

.dark {
  --background: #0a0a0a;
  --foreground: #ededed;
  --muted: #a3a3a3;
  --border: #262626;
  --hover-bg: #171717;
  --accent: #60a5fa;
}

html {
  transition: font-size 0.15s ease;
}

body {
  background: var(--background);
  color: var(--foreground);
}

/* ============================================================
   Prose — Article content typography
   ============================================================ */

.prose {
  --tw-prose-body: var(--foreground);
  --tw-prose-headings: var(--foreground);
  --tw-prose-links: var(--foreground);
  --tw-prose-bold: var(--foreground);
  --tw-prose-code: var(--foreground);
  --tw-prose-quotes: var(--muted);
  --tw-prose-quote-borders: var(--accent);
  --tw-prose-counters: var(--muted);
  --tw-prose-bullets: var(--muted);
  --tw-prose-hr: var(--border);
  --tw-prose-th-borders: var(--border);
  --tw-prose-td-borders: var(--border);
  max-width: none;
  font-size: 1.0625rem;
  line-height: 1.8;
}

.prose > * + * {
  margin-top: 1.75rem;
}

/* Headings */
.prose :is(h1, h2, h3, h4, h5, h6) {
  font-family: var(--font-space-grotesk);
  font-weight: 700;
}

.prose h2 {
  font-size: 1.6em;
  line-height: 1.2;
  letter-spacing: -0.02em;
  margin-top: 2.5rem;
}

.prose h3 {
  font-size: 1.3em;
  line-height: 1.25;
  letter-spacing: -0.017em;
  margin-top: 2rem;
}

/* Tables */
.prose table {
  font-size: 0.875em;
  border-collapse: collapse;
}

.prose :is(th, td) {
  border-bottom: 1px solid var(--border);
  padding: 0.375rem 0.75rem;
  text-align: left;
}

/* Inline code */
.prose :not(pre) > code {
  background: var(--hover-bg);
  padding: 0.15em 0.4em;
  border-radius: 0.25em;
  font-size: 0.95em;
}

.prose :not(pre) > code::before,
.prose :not(pre) > code::after {
  content: none;
}

/* Code blocks — dual-theme Shiki support */
.prose pre {
  background: var(--hover-bg) !important;
  border: 1px solid var(--border);
  border-radius: 0.375rem;
  padding: 1rem;
  overflow-x: auto;
  font-size: 0.875rem;
}

.prose pre > code {
  display: grid;
  line-height: 1.7;
  color: var(--foreground);
}

.prose pre [data-line] {
  padding: 0 0.5rem;
}

.prose pre [data-highlighted-line] {
  background: rgba(0, 0, 0, 0.05);
}

/* Hide inactive Shiki theme variant */
.dark pre[data-theme="light"],
.dark code[data-theme="light"],
html:not(.dark) pre[data-theme="dark"],
html:not(.dark) code[data-theme="dark"] {
  display: none !important;
}

/* Mermaid diagrams */
.prose svg[id^="mermaid"] {
  max-width: 100%;
  height: auto;
  display: block;
  cursor: zoom-in;
}

.mermaid-wrapper {
  position: relative;
  margin: 1.5em auto;
}

.mermaid-open-hint {
  position: absolute;
  bottom: 10px;
  right: 10px;
  background: rgba(0, 0, 0, 0.55);
  color: white;
  padding: 3px 10px;
  border-radius: 4px;
  font-size: 0.7rem;
  font-family: var(--font-geist-mono);
  letter-spacing: 0.02em;
  opacity: 0;
  transform: translateY(4px);
  transition: opacity 0.2s, transform 0.2s;
  pointer-events: none;
}

.mermaid-wrapper:hover .mermaid-open-hint {
  opacity: 1;
  transform: translateY(0);
}

/* Blockquotes */
.prose blockquote {
  border-left: 4px solid var(--accent);
  padding-left: 1.25rem;
  color: var(--muted);
  font-style: normal;
}

/* Images */
.prose img {
  border-radius: 0.375rem;
}

.prose figcaption {
  font-size: 0.875rem;
  text-align: center;
  color: var(--muted);
  margin-top: 0.75rem;
}

/* Links */
.prose a {
  text-decoration: none;
  border-bottom: 1px solid currentColor;
  transition: border-style 0.15s, color 0.15s;
}

.prose a:hover {
  border-bottom-style: dashed;
  color: var(--muted);
}

/* Lists */
.prose ul {
  list-style-type: disc;
  padding-left: 1.25em;
}

.prose ol {
  list-style-type: decimal;
  padding-left: 1.25em;
}

.prose li + li {
  margin-top: 0.375rem;
}

/* Horizontal rule */
.prose hr {
  border-color: var(--border);
  margin-top: 2rem;
  margin-bottom: 2rem;
}
